<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Find Talented Interns</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¢</text></svg>">
  <style>
/* Import Google Font */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

/* Reset and Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  /* Same color scheme as other pages */
  --background: #1A1F2C;
  --foreground: #F9F7F7;
  --card: #111824;
  --card-foreground: #F9F7F7;
  --primary: #334155;
  --primary-hover: #1E293B;
  --border: rgba(255, 255, 255, 0.1);
  --input-bg: rgba(255, 255, 255, 0.04);
  --error: #DC2626;
  --success: #10B981;
  --radius: 0.6rem;
  --shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
  --accent: #E6A55E;
  --accent-hover: #D89144;
}

body {
  font-family: 'Poppins', sans-serif;
  background-color: var(--background);
  color: var(--foreground);
  line-height: 1.6;
  min-height: 100vh;
}

/* Navigation Bar */
.navbar {
  background-color: var(--card);
  border-bottom: 1px solid var(--border);
  padding: 1rem 0;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow);
}

.nav-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent);
  text-decoration: none;
}

.nav-menu {
  display: flex;
  list-style: none;
  gap: 2rem;
  align-items: center;
}

.nav-link {
  color: var(--foreground);
  text-decoration: none;
  font-weight: 500;
  transition: color 0.3s ease;
}

.nav-link:hover {
  color: var(--accent);
}

.nav-profile {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background-color: var(--primary);
  border-radius: var(--radius);
  color: var(--foreground);
  text-decoration: none;
  transition: background-color 0.3s ease;
}

.nav-profile:hover {
  background-color: var(--primary-hover);
}

.hamburger {
  display: none;
  flex-direction: column;
  cursor: pointer;
  gap: 4px;
}

.hamburger span {
  width: 25px;
  height: 3px;
  background-color: var(--foreground);
  transition: 0.3s;
}

/* Main Content */
.main-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;
}

.page-title {
  font-size: 2.5rem;
  color: var(--accent);
  margin-bottom: 0.5rem;
}

.page-subtitle {
  font-size: 1.1rem;
  color: var(--foreground);
  opacity: 0.8;
}

/* Filter Section */
.filter-section {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 1.5rem;
  margin-bottom: 2rem;
  box-shadow: var(--shadow);
}

.filter-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.filter-title {
  font-size: 1.2rem;
  font-weight: 600;
}

.clear-filters {
  background: none;
  border: 1px solid var(--border);
  color: var(--foreground);
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.3s ease;
}

.clear-filters:hover {
  background-color: var(--primary);
}

.skills-filter {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.skill-tag {
  padding: 0.5rem 1rem;
  background-color: var(--input-bg);
  border: 1px solid var(--border);
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.skill-tag:hover {
  background-color: var(--primary);
}

.skill-tag.selected {
  background-color: var(--accent);
  color: var(--background);
  border-color: var(--accent);
}

/* Sort Section */
.sort-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding: 1rem;
  background-color: var(--card);
  border-radius: var(--radius);
}

.results-count {
  font-weight: 500;
}

.sort-dropdown {
  background-color: var(--input-bg);
  border: 1px solid var(--border);
  color: var(--foreground);
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
}

/* Profiles Grid */
.profiles-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.profile-card {
  background-color: var(--card);
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: var(--shadow);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  cursor: pointer;
  border: 1px solid var(--border);
}

.profile-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
}

.profile-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

.profile-picture {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--accent);
}

.profile-picture-placeholder {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background-color: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  color: var(--accent);
}

.profile-info h3 {
  font-size: 1.2rem;
  margin-bottom: 0.25rem;
}

.profile-headline {
  color: var(--foreground);
  opacity: 0.8;
  font-size: 0.9rem;
}

.profile-skills {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.profile-skill {
  padding: 0.25rem 0.75rem;
  background-color: var(--input-bg);
  border-radius: 15px;
  font-size: 0.8rem;
  border: 1px solid var(--border);
}

.profile-skill.matched {
  background-color: var(--accent);
  color: var(--background);
  border-color: var(--accent);
}

.profile-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--border);
}

.match-score {
  background-color: var(--success);
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: 600;
}

.view-profile-btn {
  background-color: var(--accent);
  color: var(--background);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.3s ease;
}

.view-profile-btn:hover {
  background-color: var(--accent-hover);
}

/* Loading and Empty States */
.loading {
  text-align: center;
  padding: 3rem;
  font-size: 1.1rem;
  color: var(--foreground);
  opacity: 0.7;
}

.no-results {
  text-align: center;
  padding: 3rem;
  color: var(--foreground);
  opacity: 0.7;
}

.no-results h3 {
  margin-bottom: 1rem;
  font-size: 1.5rem;
}



      /* Skills Dropdown Styles */
      .skills-dropdown-container {
        margin-bottom: 1rem;
      }
      
      .skills-dropdown {
        width: 100%;
        padding: 0.75rem 1rem;
        background-color: var(--input-bg);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        color: var(--foreground);
        font-family: 'Poppins', sans-serif;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .skills-dropdown:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 2px rgba(230, 165, 94, 0.2);
      }
      
      .skills-dropdown option {
        background-color: var(--card);
        color: var(--foreground);
        padding: 0.5rem;
      }
      
      .skills-dropdown optgroup {
        background-color: var(--primary);
        color: var(--accent);
        font-weight: 600;
        font-style: normal;
      }
      
/* Toast Notifications */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--success);
  color: white;
  padding: 15px 20px;
  border-radius: var(--radius);
  display: none;
  z-index: 1000;
  box-shadow: var(--shadow);
}

.toast.error {
  background: var(--error);
}

.toast.show {
  display: block;
}

/* Responsive Design */
@media (max-width: 768px) {
  .hamburger {
    display: flex;
  }

  .nav-menu {
    position: fixed;
    left: -100%;
    top: 70px;
    flex-direction: column;
    background-color: var(--card);
    width: 100%;
    text-align: center;
    transition: 0.3s;
    box-shadow: var(--shadow);
    padding: 2rem 0;
  }

  .nav-menu.active {
    left: 0;
  }

  .page-title {
    font-size: 2rem;
  }

  .profiles-grid {
    grid-template-columns: 1fr;
  }

  .sort-section {
    flex-direction: column;
    gap: 1rem;
    align-items: stretch;
  }

  .filter-header {
    flex-direction: column;
    gap: 1rem;
    align-items: stretch;
  }
}

@media (max-width: 480px) {
  .main-container {
    padding: 1rem 0.5rem;
  }

  .profile-card {
    padding: 1rem;
  }

  .profile-header {
    flex-direction: column;
    text-align: center;
  }
}
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="/" class="logo">InternConnect</a>
      
      <ul class="nav-menu" id="nav-menu">
        <li><a href="/startups/home" class="nav-link">Home</a></li>
        <li><a href="#" class="nav-link">Messages</a></li>
        <li><a href="#" class="nav-link">Profile</a></li>
        <li><a href="#" class="nav-profile">üë§ Profile</a></li>
      </ul>
      
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Find Talented Interns</h1>
      <p class="page-subtitle">Discover skilled interns that match your requirements</p>
    </div>

    <!-- Filter Section -->
    <div class="filter-section">
      <div class="filter-header">
        <h3 class="filter-title">Filter by Skills</h3>
        <button class="clear-filters" onclick="clearAllFilters()">Clear All</button>
      </div>
      
      <!-- Skills Dropdown -->
      <div class="skills-dropdown-container" style="margin-bottom: 1rem;">
        <select id="skills-dropdown" class="skills-dropdown" onchange="addSkillFromDropdown()">
          <option value="">Select a skill to filter...</option>
          <optgroup label="Programming Languages">
            <option value="Python">Python</option>
            <option value="JavaScript">JavaScript</option>
            <option value="Java">Java</option>
            <option value="C++">C++</option>
            <option value="C#">C#</option>
            <option value="Ruby">Ruby</option>
            <option value="PHP">PHP</option>
            <option value="Swift">Swift</option>
            <option value="Kotlin">Kotlin</option>
            <option value="Go">Go</option>
          </optgroup>
          <optgroup label="Web Development">
            <option value="HTML5">HTML5</option>
            <option value="CSS3">CSS3</option>
            <option value="React">React</option>
            <option value="Angular">Angular</option>
            <option value="Vue.js">Vue.js</option>
            <option value="Node.js">Node.js</option>
            <option value="Express.js">Express.js</option>
            <option value="Django">Django</option>
            <option value="Flask">Flask</option>
            <option value="Laravel">Laravel</option>
          </optgroup>
          <optgroup label="Databases">
            <option value="MySQL">MySQL</option>
            <option value="PostgreSQL">PostgreSQL</option>
            <option value="MongoDB">MongoDB</option>
            <option value="Redis">Redis</option>
            <option value="SQLite">SQLite</option>
            <option value="Oracle">Oracle</option>
          </optgroup>
          <optgroup label="DevOps & Tools">
            <option value="Git">Git</option>
            <option value="Docker">Docker</option>
            <option value="Kubernetes">Kubernetes</option>
            <option value="AWS">AWS</option>
            <option value="Azure">Azure</option>
            <option value="Google Cloud Platform">Google Cloud Platform</option>
            <option value="Jenkins">Jenkins</option>
            <option value="CI/CD">CI/CD</option>
          </optgroup>
          <optgroup label="Data Science & AI">
            <option value="Machine Learning">Machine Learning</option>
            <option value="Deep Learning">Deep Learning</option>
            <option value="TensorFlow">TensorFlow</option>
            <option value="PyTorch">PyTorch</option>
            <option value="Data Analysis">Data Analysis</option>
            <option value="Data Visualization">Data Visualization</option>
          </optgroup>
          <optgroup label="Mobile Development">
            <option value="React Native">React Native</option>
            <option value="Flutter">Flutter</option>
            <option value="Android Development">Android Development</option>
            <option value="iOS Development">iOS Development</option>
          </optgroup>
        </select>
      </div>
      
      <!-- Selected Skills Display -->
      <div class="skills-filter" id="skills-filter">
        <!-- Selected skills will be displayed here as tags -->
      </div>
    </div>

    <!-- Sort Section -->
    <div class="sort-section">
      <div class="results-count" id="results-count">Loading profiles...</div>
      <select class="sort-dropdown" id="sort-dropdown" onchange="sortProfiles()">
        <option value="match">Sort by: Best Match</option>
        <option value="name">Sort by: Name</option>
        <option value="skills">Sort by: Most Skills</option>
      </select>
    </div>

    <!-- Profiles Grid -->
    <div class="profiles-grid" id="profiles-grid">
      <div class="loading">Loading intern profiles...</div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <div class="toast-content"></div>
  </div>

  <script>
    // Global variables
    let allProfiles = [];
    let filteredProfiles = [];
    let selectedSkills = [];
    let allSkills = [];

    // Initialize page
    document.addEventListener('DOMContentLoaded', async function() {
  console.log('üöÄ Page loaded, initializing...');
  
  initializeNavigation();
  
  // Check authentication before loading profiles
  
  console.log('‚úÖ Loading profiles...');
  loadProfiles();
});

async function handleResponse(response) {
  if (!response.ok) {
    const errorText = await response.text();
    console.error('‚ùå Server error:', errorText);
    throw new Error(`Server error: ${response.status} - ${errorText}`);
  }

  // Parse JSON response
  let data;
  try {
    data = await response.json();
  } catch (parseError) {
    console.error('‚ùå JSON parse error:', parseError);
    throw new Error('Invalid response format from server');
  }

  console.log('üì¶ Received data:', data);

  // Check if response indicates success
  if (!data.success) {
    throw new Error(data.message || 'Failed to load profiles');
  }

  // Extract profiles
  allProfiles = data.profiles || [];
  console.log(`üìã Total profiles loaded: ${allProfiles.length}`);

  if (allProfiles.length === 0) {
    showNoResults('No intern profiles found. Interns need to create their profiles first.');
    showToast('No profiles available yet', 'info');
    return;
  }

  // Process profiles and initialize filters
  console.log('üîß Processing profiles...');
  
  // Extract all unique skills
  extractAllSkills();
  console.log(`üè∑Ô∏è Unique skills found: ${allSkills.length}`);
  
  // Initialize filters and display
  initializeSkillsFilter();
  filteredProfiles = [...allProfiles];
  displayProfiles();
  updateResultsCount();
  
  showToast(`Successfully loaded ${allProfiles.length} profiles!`, 'success');
  console.log('‚úÖ Profiles loaded and displayed successfully');
}

    // Navigation functionality
    function initializeNavigation() {
      const hamburger = document.getElementById('hamburger');
      const navMenu = document.getElementById('nav-menu');

      hamburger.addEventListener('click', function() {
        navMenu.classList.toggle('active');
      });
    }


    async function loadProfiles() {
  const profilesGrid = document.getElementById('profiles-grid');
  
  try {
    console.log('üîÑ Starting to load profiles...');
    showToast('Loading profiles...', 'info');
    
    // Show loading state
    profilesGrid.innerHTML = '<div class="loading">Loading intern profiles...</div>';
    
    // Make request to backend with absolute path
    const response = await fetch('/get_intern_profiles', {
      method: 'GET',
      credentials: 'include',
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json',
        'Cache-Control': 'no-cache'
      }
    });

    console.log('üì° Response status:', response.status);
    console.log('üì° Response ok:', response.ok);
    console.log('üì° Response URL:', response.url);

    // Handle different response statuses
    if (response.status === 401) {
      showToast('Please login to access profiles', 'error');
      window.location.href = '/login';
      return;
    }

    if (response.status === 403) {
      showToast('Access denied. Only startups can view intern profiles.', 'error');
      showNoResults('Access denied. Only startups can view intern profiles.');
      return;
    }

    if (response.status === 307 || response.status === 308) {
      // Handle redirect - try the redirected URL
      const redirectUrl = response.headers.get('Location') || '/get_intern_profiles/';
      console.log('üì° Redirecting to:', redirectUrl);
      
      const redirectResponse = await fetch(redirectUrl, {
        method: 'GET',
        credentials: 'include',
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      });
      
      return handleResponse(redirectResponse);
    }

    return handleResponse(response);

  } catch (error) {
    console.error('üí• Error loading profiles:', error);
    
    // Show user-friendly error message
    let errorMessage = 'Failed to load profiles. ';
    
    if (error.message.includes('Failed to fetch') || error.message.includes('ERR_NAME_NOT_RESOLVED')) {
      errorMessage += 'Please check your internet connection and try again.';
    } else if (error.message.includes('401')) {
      errorMessage += 'Please login to continue.';
      setTimeout(() => window.location.href = '/login', 2000);
    } else if (error.message.includes('403')) {
      errorMessage += 'Access denied.';
    } else if (error.message.includes('500')) {
      errorMessage += 'Server error. Please try again later.';
    } else {
      errorMessage += error.message;
    }
    
    showToast(errorMessage, 'error');
    showNoResults(errorMessage);
  }
}
async function checkAuth() {
  try {
    // Instead of checking /startups/home, check a simpler endpoint
    // or make a request that doesn't require authentication
    const response = await fetch('/get_intern_profiles', {
      method: 'HEAD',
      credentials: 'include'
    });
    
    console.log('üîê Auth check status:', response.status);
    
    // If we get 401, user is not authenticated
    // If we get 403, user is authenticated but not authorized (wrong role)
    // If we get 200, user is authenticated and authorized
    return response.status !== 401;
    
  } catch (error) {
    console.error('üîê Auth check failed:', error);
    return false;
  }
}

    // Extract all unique skills from profiles
    function extractAllSkills() {
      const skillsSet = new Set();
      
      allProfiles.forEach(profile => {
        if (profile.skills && Array.isArray(profile.skills)) {
          profile.skills.forEach(skill => {
            if (skill && skill.trim()) {
              skillsSet.add(skill.trim());
            }
          });
        }
      });
      
      allSkills = Array.from(skillsSet).sort();
    }

    // Initialize skills filter
    function initializeSkillsFilter() {
      const skillsFilter = document.getElementById('skills-filter');
      skillsFilter.innerHTML = '';
      
      allSkills.forEach(skill => {
        const skillTag = document.createElement('div');
        skillTag.className = 'skill-tag';
        skillTag.textContent = skill;
        skillTag.onclick = () => toggleSkillFilter(skill, skillTag);
        skillsFilter.appendChild(skillTag);
      });
    }

    // Toggle skill filter
    function toggleSkillFilter(skill, element) {
      if (selectedSkills.includes(skill)) {
        selectedSkills = selectedSkills.filter(s => s !== skill);
        element.classList.remove('selected');
      } else {
        selectedSkills.push(skill);
        element.classList.add('selected');
      }
      
      filterProfiles();
    }

    // Add skill from dropdown
    function addSkillFromDropdown() {
      const dropdown = document.getElementById('skills-dropdown');
      const selectedSkill = dropdown.value;
      
      if (selectedSkill && !selectedSkills.includes(selectedSkill)) {
        selectedSkills.push(selectedSkill);
        
        // Create and add skill tag
        const skillsFilter = document.getElementById('skills-filter');
        const skillTag = document.createElement('div');
        skillTag.className = 'skill-tag selected';
        skillTag.textContent = selectedSkill;
        skillTag.onclick = () => removeSkillFilter(selectedSkill, skillTag);
        skillsFilter.appendChild(skillTag);
        
        // Reset dropdown
        dropdown.value = '';
        
        // Filter profiles
        filterProfiles();
      }
    }
    
    // Remove skill filter
    function removeSkillFilter(skill, element) {
      selectedSkills = selectedSkills.filter(s => s !== skill);
      element.remove();
      filterProfiles();
    }
    
    // Update the clear all filters function
    function clearAllFilters() {
      selectedSkills = [];
      document.getElementById('skills-filter').innerHTML = '';
      document.getElementById('skills-dropdown').value = '';
      filterProfiles();
    }
    
    // Update the initialize skills filter function
    function initializeSkillsFilter() {
      // Clear any existing selected skills
      document.getElementById('skills-filter').innerHTML = '';
      selectedSkills = [];
    }

    // Clear all filters
    function clearAllFilters() {
      selectedSkills = [];
      document.querySelectorAll('.skill-tag').forEach(tag => {
        tag.classList.remove('selected');
      });
      filterProfiles();
    }

    // Filter profiles based on selected skills
    function filterProfiles() {
      if (selectedSkills.length === 0) {
        filteredProfiles = [...allProfiles];
      } else {
        filteredProfiles = allProfiles.filter(profile => {
          if (!profile.skills || !Array.isArray(profile.skills)) {
            return false;
          }
          
          return selectedSkills.some(selectedSkill => 
            profile.skills.some(profileSkill => 
              profileSkill && profileSkill.toLowerCase().includes(selectedSkill.toLowerCase())
            )
          );
        });
      }
      
      // Calculate match scores
      calculateMatchScores();
      
      // Sort and display
      sortProfiles();
    }

    // Calculate match scores for profiles
    function calculateMatchScores() {
      filteredProfiles.forEach(profile => {
        if (selectedSkills.length === 0) {
          profile.matchScore = 0;
          return;
        }
        
        if (!profile.skills || !Array.isArray(profile.skills)) {
          profile.matchScore = 0;
          return;
        }
        
        const matchedSkills = selectedSkills.filter(selectedSkill => 
          profile.skills.some(profileSkill => 
            profileSkill && profileSkill.toLowerCase().includes(selectedSkill.toLowerCase())
          )
        );
        
        profile.matchScore = Math.round((matchedSkills.length / selectedSkills.length) * 100);
      });
    }

    // Sort profiles
    function sortProfiles() {
      const sortBy = document.getElementById('sort-dropdown').value;
      
      switch (sortBy) {
        case 'match':
          filteredProfiles.sort((a, b) => (b.matchScore || 0) - (a.matchScore || 0));
          break;
        case 'name':
          filteredProfiles.sort((a, b) => (a.name || '').localeCompare(b.name || ''));
          break;
        case 'skills':
          filteredProfiles.sort((a, b) => (b.skills?.length || 0) - (a.skills?.length || 0));
          break;
      }
      
      displayProfiles();
      updateResultsCount();
    }

    // Display profiles
    function displayProfiles() {
      const profilesGrid = document.getElementById('profiles-grid');
      
      if (filteredProfiles.length === 0) {
        showNoResults('No interns match your selected skills. Try adjusting your filters.');
        return;
      }
      
      profilesGrid.innerHTML = '';
      
      filteredProfiles.forEach(profile => {
        const profileCard = createProfileCard(profile);
        profilesGrid.appendChild(profileCard);
      });
    }

    // Create profile card
    function createProfileCard(profile) {
      const card = document.createElement('div');
      card.className = 'profile-card';
      card.onclick = () => viewProfile(profile);
      
      const profilePicture = profile.profilePicture ? 
        `<img src="${profile.profilePicture}" alt="${profile.name || 'Profile'}" class="profile-picture">` :
        `<div class="profile-picture-placeholder">üë§</div>`;
      
      const skills = profile.skills && Array.isArray(profile.skills) ? 
        profile.skills.slice(0, 5).map(skill => {
          const isMatched = selectedSkills.some(selectedSkill => 
            skill.toLowerCase().includes(selectedSkill.toLowerCase())
          );
          return `<span class="profile-skill ${isMatched ? 'matched' : ''}">${skill}</span>`;
        }).join('') : '';
      
      const matchScore = selectedSkills.length > 0 && profile.matchScore > 0 ? 
        `<div class="match-score">${profile.matchScore}% match</div>` : '';
      
      card.innerHTML = `
        <div class="profile-header">
          ${profilePicture}
          <div class="profile-info">
            <h3>${profile.fullName || 'Anonymous'}</h3>
            <p class="profile-headline">${profile.headline || 'Aspiring Professional'}</p>
          </div>
        </div>
        
        ${skills ? `
        <div class="profile-skills">
          ${skills}
          ${profile.skills && profile.skills.length > 5 ? `<span class="profile-skill">+${profile.skills.length - 5} more</span>` : ''}
        </div>` : ''}
        
        <div class="profile-footer">
          ${matchScore}
          <button class="view-profile-btn" onclick="event.stopPropagation(); viewProfile(profile)">View Profile</button>
        </div>
      `;
      
      return card;
    }

    // View individual profile
    function viewProfile(profile) {
      // Store profile data for the detail page
      localStorage.setItem('selectedInternProfile', JSON.stringify(profile));
      
      // Navigate to profile detail page
      window.location.href = '/intern/profile/view';
    }

    // Update results count
    function updateResultsCount() {
      const resultsCount = document.getElementById('results-count');
      const total = allProfiles.length;
      const filtered = filteredProfiles.length;
      
      if (selectedSkills.length > 0) {
        resultsCount.textContent = `Showing ${filtered} of ${total} interns`;
      } else {
        resultsCount.textContent = `${total} interns available`;
      }
    }

    // Show no results message
    function showNoResults(message) {
      const profilesGrid = document.getElementById('profiles-grid');
      profilesGrid.innerHTML = `
        <div class="no-results">
          <h3>No Results Found</h3>
          <p>${message}</p>
        </div>
      `;
      
      document.getElementById('results-count').textContent = '0 interns found';
    }

    // Toast notification system
    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      const toastContent = toast.querySelector('.toast-content');
      
      toast.className = 'toast show ' + type;
      toastContent.textContent = message;
      
      setTimeout(() => {
        toast.className = 'toast';
      }, 3000);
    }
  </script>
</body>
</html>
